\section{Methodology}

For proper analysis of an android application a testing environment has to be configured.
Each member had chosen to either work in a virtual machine or use their local machine to test the application.
Using a local machine, every member must consider their own safety when working with malicious software.
Publicly available tools were also properly setup on the local or virtual machine such as Android Studio, mitmproxy and Wireshark.

\subsection{Finding the malicious applications}

For the research it was decided that all the selected applications had come from the site Koodous and had confirmed to be malicious with the site VirusTotal.
This had been done individually by all team members to find applicable APK files for the research.
Some checks were performed manually to see if the applications contained any pointers that indicated that they contained malware.
The application was checked on its availability for download on the Google Play store.
The potentially malicious application was compared with the variant from the Google Play store.
A few examples of these pointers were differing sizes or if both had the exact same package name as the Google Play store variant while differing in permissions or certificates.
If it had one of those pointers, then it likely was an indicator that there was something extra hidden in the code.

The application was retrieved from both Koodous and the Google Play Store.
The APK from Google Play was downloaded using the apkcombo.com website.
Both APK files were uploaded to VirusTotal to check for any differences in permissions between the two versions of the application.
Anything VirusTotal had marked as malicious, was noted.
It was up to the discretion of each individual team member to decide on the application they wanted to work on for the duration of the project.

\subsection{Behavior analysis}

The research required that each team member had one application to examine.
This had been done on a virtual computer, with android studio installed, or locally.
During the installation of the application the network traffic was captured.
This was done using Wireshark and mitmproxy.
The network traffic was not relevant for the behavior analysis but was captured as part of the network analysis.

The behavior analysis was predominantly about using the application from a users point of view and noting anything out of the ordinary.
This was also compared step by step to the original (non-malicious) application.
The differences between the two were noted for further investigative purposes.
The ordinary behavior was investigated further during network and code analysis.

\subsection{Network analysis}

During the behavior analysis the network traffic from the application was captured using Wireshark and mitmproxy.
During the network analysis this captured network traffic was analyzed using a combination of Wireshark, mitmproxy and shodan.io.
Wireshark was used to capture all network data that was sent by the application and gave the opertunity to perform a deep analysis what exactly was sent.
Mitmproxy was used to capture all http and https requests, this was used to find what IP-addresses connections were made to.
During the analysis anything that stood out like any IP addresses and or domain names were written down.

Shodan.io was used for analyzing the IP addresses and domain names found with Wireshark and mitmproxy.
Wireshark and mitmproxy were able to reveal all the network traffic sent and received by the application.
Shodan.io revealed the other functions of the servers and whether there are similar servers, perhaps from the same hosting provider.

\subsection{Code analysis}

For the code analysis, JadX and Dex2Jar were used to decompile the application.
These applications turned the single .apk files into structured files, which were readable for the code analysis.
This created the opportunity to read the code.
An attempt was made to analyze the code.
Analyzing the code was very difficult due to obfuscation.
Where possible it was documented whether the code was malicious or not.

\subsection{Process analysis}
The Processes were analyzed to gain the insights that the research needs.
The application was started in the emulator of Android Studio.
During the startup and use of the application, the Memory profiler was used to monitor the memory usage of the application.
All memory usage was documented and all peculiar behavior had been investigated further, to understand what had caused the suspicious behavior.
Optionally, a heap dump was done during execution, which led to interesting findings.

\subsection{Countermeasures and detection}

To finalize the analysis, a YARA ruleset had been created for the application.
To inform end users, methods have been documented that the end user can apply to mitigate the effects of the malicious code.
All findings were documented into a report which was delivered to the team leader.
These steps were performed by all the members.
If an application needed additional steps this was declared at the start of the application chapter.