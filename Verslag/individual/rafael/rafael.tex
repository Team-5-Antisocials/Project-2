\section{'DHL Express Mobile' Application Analysis by Rafael}

The application that was analyzed in this chapter had the name 'DHL'.
The application was found on \href{https://koodous.com/apks/38ff459a46e9ea6d63a83c1eddb640626fef562cd1bcb0ab3823c4770d07d0fb}{Koodous} with the version \texttt{1.0} and package name \texttt{com.ru.dhl}, the size was \texttt{2.7 MB}.
The same package name did not exist on the Google Play Store. However, an application with the same icon was found \href{https://play.google.com/store/apps/details?id=com.dhl.exp.dhlmobile}{here}. It has the version \texttt{2.7.0}, package name \texttt{com.dhl.exp.dhlmobile} and a size of \texttt{25 MB}.

The application found on Koodous and the application found on the Google Play Store will hereinafter be referred to as 'Malicious application' and 'Original application' respectively.

\newpage
\subsection{VirusTotal summary}

VirusTotal indicated that the malicious application was marked by 33/63 security vendors as malicious, 
and that the original application was marked by 0/60 security vendors as malicious.

The malicious application was primarily marked as a Banker\footnote{A banker generally is an application that attempts to steal banking information in order to steal the users money.}. 
If it was not marked as a banker it was either marked as a Trojan\footnote{A Trojan (or 'Trojan Horse malware') is a blanket term for malicious software that disguises itself as a harmless application} or a non repeating name.
This was the full list


\begin{tabular}{ |l|l| }
    \hline
    \textbf{Vendor} & \textbf{Detection} \\
    
    \hline
        Ad-Aware    &   Trojan.GenericKD.37488882 \\
    \hline
        Alibaba     &   TrojanSpy:Android/Banker.66c12705 \\
    \hline
        Antiy-AVL   &   Trojan/Generic.ASMalwAD.5B \\
    \hline
        Arcabit     &   Trojan.Generic.D23C08F2 \\
    \hline
        Avast-Mobile    &   APK:RepSandbox [Trj] \\
    \hline
        Avira (no cloud)    &   ANDROID/Spy.Banker.YD.Gen \\
    \hline
        BitDefender     &   Trojan.GenericKD.37488882 \\
    \hline
        BitDefenderFalx     &   Android.Trojan.Banker.WS \\
    \hline
        CAT-QuickHeal   &   Android.AbereBot.Af9d \\
    \hline
        Cynet   &   Malicious (score: 99) \\
    \hline
        DrWeb   &   Android.BankBot.852.origin \\
    \hline
        Emsisoft    &   Trojan.GenericKD.37488882 (B) \\
    \hline
        eScan   &   Trojan.GenericKD.37488882 \\
    \hline
        ESET-NOD32  &   A Variant Of Android/Spy.Banker.AZU \\
    \hline
        F-Secure    &   Malware.ANDROID/Spy.Banker.YD.Gen \\
    \hline
        FireEye     &   Trojan.GenericKD.37488882 \\
    \hline
        Fortinet    &   Android/AbereBot.A!tr \\
    \hline
        GData   &   Trojan.GenericKD.37488882 \\
    \hline
        Gridinsoft  &   Trojan.U.Banker.oa \\
    \hline
        Ikarus  &   Trojan.AndroidOS.Banker \\
    \hline
        K7GW    &   Spyware ( 005817811 ) \\
    \hline
        Kaspersky   &   HEUR:Trojan-Banker.AndroidOS.AbereBot.a \\
    \hline
        Kingsoft    &   Android.Troj.tn-banker.azu.(kcloud) \\
    \hline
        Lionic  &   Trojan.AndroidOS.AbereBot.C!c \\
    \hline
        MAX     &   Malware (ai Score=100) \\
    \hline
        McAfee  &   Artemis!4778ACA48D17 \\
    \hline
        McAfee-GW-Edition   &   Artemis!Trojan \\
    \hline
        Microsoft   &   TrojanSpy:AndroidOS/Banker.GV!MTB \\
    \hline
        Symantec    &   Trojan.Gen.MBT \\
    \hline
        Symantec Mobile Insight     &   AppRisk:Generisk \\
    \hline
        Tencent     &   A.privacy.AnubisTrojanBanking \\
    \hline
        Trustlook   &   Android.Malware.Trojan \\
    \hline
        ZoneAlarm by Check Point    &   HEUR:Trojan-Banker.AndroidOS.AbereBot.a \\
    \hline
\end{tabular}

\newpage
\subsubsection{Permission requests}
\subsubsubsection{Malicious application}
The malicious application requested the following permissions:

\texttt{android.permission.ACCESS\_NETWORK\_STATE}
\newline \texttt{android.permission.ACCESS\_WIFI\_STATE}
\newline \texttt{android.permission.CALL\_PHONE}
\newline \texttt{android.permission.CHANGE\_WIFI\_STATE}
\newline \texttt{android.permission.FOREGROUND\_SERVICE}
\newline \texttt{android.permission.INTERNET}
\newline \texttt{android.permission.MODIFY\_AUDIO\_SETTINGS}
\newline \texttt{android.permission.READ\_CALL\_LOG}
\newline \texttt{android.permission.READ\_CONTACTS}
\newline \texttt{android.permission.READ\_PHONE\_STATE}
\newline \texttt{android.permission.READ\_PRIVILEGED\_PHONE\_STATE}
\newline \texttt{android.permission.READ\_SMS}
\newline \texttt{android.permission.RECEIVE\_BOOT\_COMPLETED}
\newline \texttt{android.permission.RECEIVE\_SMS}
\newline \texttt{android.permission.REQUEST\_DELETE\_PACKAGES}
\newline \texttt{android.permission.REQUEST\_IGNORE\_BATTERY\_OPTIMIZATIONS}
\newline \texttt{android.permission.SEND\_SMS}
\newline \texttt{android.permission.SHUTDOWN}
\newline \texttt{android.permission.UPDATE\_DEVICE\_STATS}
\newline \texttt{android.permission.WAKE\_LOCK}
\newline \texttt{android.permission.WRITE\_CALL\_LOG}
\newline \texttt{android.permission.WRITE\_CONTACTS}

\newpage
\subsubsubsection{Original application}
The original application requested the following permissions:

\texttt{android.permission.CALL\_PHONE}
\newline \texttt{android.permission.FLASHLIGHT}
\newline \texttt{android.permission.READ\_APP\_BADGE}
\newline \texttt{android.permission.READ\_EXTERNAL\_STORAGE}
\newline \texttt{android.permission.READ\_PHONE\_STATE}
\newline \texttt{android.permission.USE\_FINGERPRINT}
\newline \texttt{android.permission.WRITE\_EXTERNAL\_STORAGE}
\newline \texttt{com.anddoes.launcher.permission.UPDATE\_COUNT}
\newline \texttt{com.dhl.exp.dhlmobile.permission.C2D\_MESSAGE}
\newline \texttt{com.google.android.c2dm.permission.RECEIVE}
\newline \texttt{com.htc.launcher.permission.READ\_SETTINGS}
\newline \texttt{com.htc.launcher.permission.UPDATE\_SHORTCUT}
\newline \texttt{com.huawei.android.launcher.permission.CHANGE\_BADGE}
\newline \texttt{com.huawei.android.launcher.permission.READ\_SETTINGS}
\newline \texttt{com.huawei.android.launcher.permission.WRITE\_SETTINGS}
\newline \texttt{com.majeur.launcher.permission.UPDATE\_BADGE}
\newline \texttt{com.oppo.launcher.permission.READ\_SETTINGS}
\newline \texttt{com.oppo.launcher.permission.WRITE\_SETTINGS}
\newline \texttt{com.sec.android.provider.badge.permission.READ}
\newline \texttt{com.sec.android.provider.badge.permission.WRITE}
\newline \texttt{com.sonyericsson.home.permission.BROADCAST\_BADGE}
\newline \texttt{com.sonymobile.home.permission.PROVIDER\_INSERT\_BADGE}
\newline \texttt{me.everything.badger.permission.BADGE\_COUNT\_READ}
\newline \texttt{me.everything.badger.permission.BADGE\_COUNT\_WRITE}



\newpage
\subsection{Behavior analysis}

<what does the app behave like when installed and ran>

\newpage
\subsection{Network analysis}

<what does the network traffic look like>

\subsubsection{HTTP proxy analysis}

<what did the proxy reveal about the network traffic>

\subsubsection{Wireshark analysis}

<what did WireShark reveal about the network traffic>

\subsubsection{Reconnaissance [optional]}

<what was found using shodan.io>

\newpage
\subsection{Code analysis}

<interesting stuff found in code>

\newpage
\subsection{Process analysis}

<interesting stuff found in the process and memory, etc.>

\newpage
\subsection{Countermeasures and detection}

\subsubsection{Preventive measures}


<Measures to prevent installing this application>

\subsubsection{Detective measures}

<Measures to detect if this application is installed>

\subsubsection{Reactive measures}

<What to do if it is installed>

\subsubsection{YARA rule set}

<A YARA rule set created based on your findings>
